## GOID Term name assigment

## Load Packages
library(dplyr)
library(GO.db)

## GeneID-GO data curation from annotators
All_gene2GO <- data.frame(
  GeneID = all_annotations$GeneID, 
  GO_ID = paste(all_annotations$gaf_GO_ID, all_annotations$emapper_GO_ID, all_annotations$pannzer_GO_ID, all_annotations$interpro_GO_ID, sep = "/")
  )

All_gene2GO <- All_gene2GO %>%
  separate_rows(GO_ID, sep = "/")

All_gene2GO <- All_gene2GO %>%
  filter(!grepl("-", GO_ID))

All_gene2GO <- All_gene2GO %>%
  distinct(GeneID, GO_ID, .keep_all = TRUE)

## Unique GO ID's list
unique_allgo <- na.omit(unique(All_gene2GO$GO_ID))

length(unique_allgo)

## Function to asign each GO ID a GO term including obsolete GO terms
get_go_term <- function(go_id) {
    if (go_id %in% keys(GOTERM)) {
    return(Term(GOTERM[[go_id]]))
  }
  if (go_id %in% keys(GOOBSOLETE)) {
    return(paste("Obsolete:", Term(GOOBSOLETE[[go_id]])))
  }
  return(paste("GO term", go_id, "not found in the database"))
}

## Perform the mapping
allgo_annotation <- sapply(unique_allgo, get_go_term)
all_terms_to_id <- data.frame(GO_ID = names(allgo_annotation), GO_Term = as.character(allgo_annotation), stringsAsFactors = FALSE)


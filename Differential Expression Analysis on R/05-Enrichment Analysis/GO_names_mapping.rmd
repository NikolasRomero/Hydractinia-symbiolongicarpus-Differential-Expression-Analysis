## GOID Term name assigment

## Load Packages
library(dplyr)
library(GO.db)

## Unique GO ID's list
unique_allgo <- na.omit(unique(All_gene2GO$GO_ID))

length(unique_allgo)

## Function to asign each GO ID a GO term including obsolete GO terms
get_go_term <- function(go_id) {
    if (go_id %in% keys(GOTERM)) {
    return(Term(GOTERM[[go_id]]))
  }
  if (go_id %in% keys(GOOBSOLETE)) {
    return(paste("Obsolete:", Term(GOOBSOLETE[[go_id]])))
  }
  return(paste("GO term", go_id, "not found in the database"))
}

## Perform the mapping
allgo_annotation <- sapply(unique_allgo, get_go_term)
all_terms_to_id <- data.frame(GO_ID = names(allgo_annotation), GO_Term = as.character(allgo_annotation), stringsAsFactors = FALSE)

